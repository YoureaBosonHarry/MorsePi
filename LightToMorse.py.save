import cv2
import numpy as np
from queue import Queue
import time
from threading import Thread

frame_rate = 10
last_frame = 0
led_constant = 1.5
time_constant = 0.1
on = 0

def detect_light(image):
    global last_frame
    global on
    pixel_sum = cv2.sumElems(image)
    pixel_sum = np.sum(pixel_sum)
    if pixel_sum > led_constant*last_frame:
        on += time.time()
        print(on, last_frame)
    last_frame = pixel_sum

cap = cv2.VideoCapture(0)
time.sleep(2)

while True:
    ret, frame = cap.read()
    if type(frame) == type(None):
        break
    detect_light(frame)
    time.sleep(1/frame_rate)
    if cv2.waitKey(1) & 0xFF == ord('q'):
        break
